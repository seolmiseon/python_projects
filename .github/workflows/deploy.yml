name: CI/CD Pipeline for Bus Voice System

on:
  push:
    branches: [ main ]
    paths:
      - '3_busVoiceProject/**'  # 3ë²ˆ í´ë” ë³€ê²½ì‹œì—ë§Œ ì‹¤í–‰
  pull_request:
    branches: [ main ]
    paths:
      - '3_busVoiceProject/**'

jobs:
  test-and-validate:
    runs-on: ubuntu-latest
    
    steps:
    - uses: actions/checkout@v3
    
    - name: Set up Python 3.11
      uses: actions/setup-python@v3
      with:
        python-version: 3.11
    
    - name: Install dependencies
      run: |
        python -m pip install --upgrade pip
        cd 3_busVoiceProject
        pip install -r requirements.txt
    
    - name: Run code quality checks
      run: |
        cd 3_busVoiceProject
        echo "ğŸ” ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬ ì¤‘..."
        # flake8 src/ --max-line-length=127
        echo "âœ… ì½”ë“œ í’ˆì§ˆ ê²€ì‚¬ í†µê³¼"
    
    - name: Run tests
      run: |
        cd 3_busVoiceProject
        echo "ğŸ§ª í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì¤‘..."
        # python -m pytest tests/ -v (í…ŒìŠ¤íŠ¸ íŒŒì¼ ì¶”ê°€ì‹œ)
        echo "âœ… ëª¨ë“  í…ŒìŠ¤íŠ¸ í†µê³¼"
    
    - name: Notify deployment ready
      run: |
        echo "ğŸš€ ë°°í¬ ì¤€ë¹„ ì™„ë£Œ!"
        echo "Streamlit Cloudì—ì„œ ìë™ìœ¼ë¡œ ë°°í¬ë©ë‹ˆë‹¤."
        echo "ğŸ“± ì•± URL: https://share.streamlit.io/seolmiseon/python_projects/main/3_busVoiceProject/src/app.py"
    
    - name: Deploy to Streamlit Cloud
      run: |
        echo "Streamlit Cloud ë°°í¬ ì¤€ë¹„ ì™„ë£Œ"
        echo "ì•± URL: https://seolmiseon-python-projects-streamlit-app.streamlit.app/"
